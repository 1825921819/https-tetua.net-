mixin Messages(msgs)
  if msgs.Length() > 0
    ul.messages
      - var messages = msgs.Get()
      each msg in messages
        li(class=msg.Type)=msg.Message


mixin helpCompose()
  strong(style='margin-bottom:5px;display:block') Writing a Great Post
  ul
    li
      | Using markdown shortcut to compose your post.
    li
      | Use the Markdown switch button to toggle between rich text and plain markdown editor mode.
    li
      | Select the topics that represent for the post content.

mixin helpManage()
  +helpCompose()

mixin helpDetail()
  +helpCompose()

mixin newButton(label, link)
  a.link-icon(href=link)
    svg(style='width:24px;height:24px' viewBox='0 0 24 24')
      path(fill='currentColor' d='M17,13H13V17H11V13H7V11H11V7H13V11H17M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z')
    =label

mixin manageMenu()
  h2.header
    a(href=utils.Url("/manage")) Manage
  ul.manage-features
    li
      a(href=utils.Url("/manage/topics"))
        svg(viewBox='0 0 24 24')
          path(fill='currentColor' d='M9,1H19A2,2 0 0,1 21,3V19L19,18.13V3H7A2,2 0 0,1 9,1M15,20V7H5V20L10,17.82L15,20M15,5C16.11,5 17,5.9 17,7V23L10,20L3,23V7A2,2 0 0,1 5,5H15Z')
        | Topics
    li
      a(href=utils.Url("/manage/posts"))
        svg(viewBox='0 0 24 24')
          path(fill='currentColor' d='M20 5L20 19L4 19L4 5H20M20 3H4C2.89 3 2 3.89 2 5V19C2 20.11 2.89 21 4 21H20C21.11 21 22 20.11 22 19V5C22 3.89 21.11 3 20 3M18 15H6V17H18V15M10 7H6V13H10V7M12 9H18V7H12V9M18 11H12V13H18V11Z')
        | Posts
    li
      a(href=utils.Url("/manage/pages"))
        svg(viewBox='0 0 24 24')
          path(fill='currentColor' d='M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z')
        | Pages
    li
      a(href=utils.Url("/manage/roles"))
        svg(viewBox='0 0 24 24')
          path(fill='currentColor' d='M17 14.4C17.6 14.4 18.1 14.9 18.1 15.5S17.6 16.6 17 16.6 15.9 16.1 15.9 15.5 16.4 14.4 17 14.4M17 17.5C16.3 17.5 14.8 17.9 14.8 18.6C15.3 19.3 16.1 19.8 17 19.8S18.7 19.3 19.2 18.6C19.2 17.9 17.7 17.5 17 17.5M18 11.1V6.3L10.5 3L3 6.3V11.2C3 15.7 6.2 20 10.5 21C11.1 20.9 11.6 20.7 12.1 20.5C13.2 22 15 23 17 23C20.3 23 23 20.3 23 17C23 14 20.8 11.6 18 11.1M11 17C11 17.6 11.1 18.1 11.2 18.6C11 18.7 10.7 18.8 10.5 18.9C7.3 17.9 5 14.7 5 11.2V7.6L10.5 5.2L16 7.6V11.1C13.2 11.6 11 14 11 17M17 21C14.8 21 13 19.2 13 17S14.8 13 17 13 21 14.8 21 17 19.2 21 17 21Z')
        | Roles
    li
      a(href=utils.Url("/manage/users"))
        svg(viewBox='0 0 24 24')
          path(fill='currentColor' d='M13.07 10.41A5 5 0 0 0 13.07 4.59A3.39 3.39 0 0 1 15 4A3.5 3.5 0 0 1 15 11A3.39 3.39 0 0 1 13.07 10.41M5.5 7.5A3.5 3.5 0 1 1 9 11A3.5 3.5 0 0 1 5.5 7.5M7.5 7.5A1.5 1.5 0 1 0 9 6A1.5 1.5 0 0 0 7.5 7.5M16 17V19H2V17S2 13 9 13 16 17 16 17M14 17C13.86 16.22 12.67 15 9 15S4.07 16.31 4 17M15.95 13A5.32 5.32 0 0 1 18 17V19H22V17S22 13.37 15.94 13Z')
        | Users
    li
      a(href=utils.Url("/manage/comments"))
        svg(viewBox='0 0 24 24')
          path(fill='currentColor' d='M20 2H4C2.9 2 2 2.9 2 4V22L6 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2M20 16H5.2L4 17.2V4H20V16Z')
        | Comments
    li
      a(href=utils.Url("/manage/files"))
        svg(viewBox='0 0 24 24')
          path(fill='currentColor' d='M21,17H7V3H21M21,1H7A2,2 0 0,0 5,3V17A2,2 0 0,0 7,19H21A2,2 0 0,0 23,17V3A2,2 0 0,0 21,1M3,5H1V21A2,2 0 0,0 3,23H19V21H3M15.96,10.29L13.21,13.83L11.25,11.47L8.5,15H19.5L15.96,10.29Z')
        | Files
    li
      a(href=utils.Url("/manage/settings"))
        svg(viewBox='0 0 24 24')
          path(fill='currentColor' d='M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8M12,10A2,2 0 0,0 10,12A2,2 0 0,0 12,14A2,2 0 0,0 14,12A2,2 0 0,0 12,10M10,22C9.75,22 9.54,21.82 9.5,21.58L9.13,18.93C8.5,18.68 7.96,18.34 7.44,17.94L4.95,18.95C4.73,19.03 4.46,18.95 4.34,18.73L2.34,15.27C2.21,15.05 2.27,14.78 2.46,14.63L4.57,12.97L4.5,12L4.57,11L2.46,9.37C2.27,9.22 2.21,8.95 2.34,8.73L4.34,5.27C4.46,5.05 4.73,4.96 4.95,5.05L7.44,6.05C7.96,5.66 8.5,5.32 9.13,5.07L9.5,2.42C9.54,2.18 9.75,2 10,2H14C14.25,2 14.46,2.18 14.5,2.42L14.87,5.07C15.5,5.32 16.04,5.66 16.56,6.05L19.05,5.05C19.27,4.96 19.54,5.05 19.66,5.27L21.66,8.73C21.79,8.95 21.73,9.22 21.54,9.37L19.43,11L19.5,12L19.43,13L21.54,14.63C21.73,14.78 21.79,15.05 21.66,15.27L19.66,18.73C19.54,18.95 19.27,19.04 19.05,18.95L16.56,17.95C16.04,18.34 15.5,18.68 14.87,18.93L14.5,21.58C14.46,21.82 14.25,22 14,22H10M11.25,4L10.88,6.61C9.68,6.86 8.62,7.5 7.85,8.39L5.44,7.35L4.69,8.65L6.8,10.2C6.4,11.37 6.4,12.64 6.8,13.8L4.68,15.36L5.43,16.66L7.86,15.62C8.63,16.5 9.68,17.14 10.87,17.38L11.24,20H12.76L13.13,17.39C14.32,17.14 15.37,16.5 16.14,15.62L18.57,16.66L19.32,15.36L17.2,13.81C17.6,12.64 17.6,11.37 17.2,10.2L19.31,8.65L18.56,7.35L16.15,8.39C15.38,7.5 14.32,6.86 13.12,6.62L12.75,4H11.25Z')
        | Settings

mixin userMenu()
  .meta.flex
    !=meta.User.AvatarElm('32', '32', false)
    div
      a.author(href=meta.User.Url())=meta.User.Name()
      div.stat.flex
        span="@" + meta.User.Username
  ul.manage-features
    li
      a(href=utils.Url("/posts/new"))
        svg(style='width:24px;height:24px' viewBox='0 0 24 24')
          path(fill='currentColor' d='M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M13,7H11V11H7V13H11V17H13V13H17V11H13V7Z')
        | New post
    li
      a(href=utils.Url("/posts"))
        svg(viewBox='0 0 24 24')
          path(fill='currentColor' d='M20 5L20 19L4 19L4 5H20M20 3H4C2.89 3 2 3.89 2 5V19C2 20.11 2.89 21 4 21H20C21.11 21 22 20.11 22 19V5C22 3.89 21.11 3 20 3M18 15H6V17H18V15M10 7H6V13H10V7M12 9H18V7H12V9M18 11H12V13H18V11Z')
        | My Posts
    li
      a(href=utils.Url("/comments"))
        svg(viewBox='0 0 24 24')
          path(fill='currentColor' d='M20 2H4C2.9 2 2 2.9 2 4V22L6 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2M20 16H5.2L4 17.2V4H20V16Z')
        | My Comments
    li
      a(href=utils.Url("/files"))
        svg(viewBox='0 0 24 24')
          path(fill='currentColor' d='M21,17H7V3H21M21,1H7A2,2 0 0,0 5,3V17A2,2 0 0,0 7,19H21A2,2 0 0,0 23,17V3A2,2 0 0,0 21,1M3,5H1V21A2,2 0 0,0 3,23H19V21H3M15.96,10.29L13.21,13.83L11.25,11.47L8.5,15H19.5L15.96,10.29Z')
        | My Files
    li
      a(href=utils.Url("/settings"))
        svg(viewBox='0 0 24 24')
          path(fill='currentColor' d='M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8M12,10A2,2 0 0,0 10,12A2,2 0 0,0 12,14A2,2 0 0,0 14,12A2,2 0 0,0 12,10M10,22C9.75,22 9.54,21.82 9.5,21.58L9.13,18.93C8.5,18.68 7.96,18.34 7.44,17.94L4.95,18.95C4.73,19.03 4.46,18.95 4.34,18.73L2.34,15.27C2.21,15.05 2.27,14.78 2.46,14.63L4.57,12.97L4.5,12L4.57,11L2.46,9.37C2.27,9.22 2.21,8.95 2.34,8.73L4.34,5.27C4.46,5.05 4.73,4.96 4.95,5.05L7.44,6.05C7.96,5.66 8.5,5.32 9.13,5.07L9.5,2.42C9.54,2.18 9.75,2 10,2H14C14.25,2 14.46,2.18 14.5,2.42L14.87,5.07C15.5,5.32 16.04,5.66 16.56,6.05L19.05,5.05C19.27,4.96 19.54,5.05 19.66,5.27L21.66,8.73C21.79,8.95 21.73,9.22 21.54,9.37L19.43,11L19.5,12L19.43,13L21.54,14.63C21.73,14.78 21.79,15.05 21.66,15.27L19.66,18.73C19.54,18.95 19.27,19.04 19.05,18.95L16.56,17.95C16.04,18.34 15.5,18.68 14.87,18.93L14.5,21.58C14.46,21.82 14.25,22 14,22H10M11.25,4L10.88,6.61C9.68,6.86 8.62,7.5 7.85,8.39L5.44,7.35L4.69,8.65L6.8,10.2C6.4,11.37 6.4,12.64 6.8,13.8L4.68,15.36L5.43,16.66L7.86,15.62C8.63,16.5 9.68,17.14 10.87,17.38L11.24,20H12.76L13.13,17.39C14.32,17.14 15.37,16.5 16.14,15.62L18.57,16.66L19.32,15.36L17.2,13.81C17.6,12.64 17.6,11.37 17.2,10.2L19.31,8.65L18.56,7.35L16.15,8.39C15.38,7.5 14.32,6.86 13.12,6.62L12.75,4H11.25Z')
        | Settings

mixin topicSelect(name, topics, current)
  select(name=name)
    option(value='') --
    each t in topics
      if t.ID == current.ParentID
        option(value=t.ID, selected='selected')=t.Name
      else
        option(value=t.ID)=t.Name

mixin topicCheckboxMulti(name, topics, selected)
  .multi-checkbox.scroll
    each topic in topics
      - var inputId = fmt.Sprintf("topic-%d", topic.ID)
      if utils.SliceContains(selected, topic.ID)
        label(for=inputId)
          input(type='checkbox', name=name, value=topic.ID, id=inputId, checked='checked')
          span.name=topic.Name
      else
        label(for=inputId)
          input(type='checkbox', name=name, value=topic.ID, id=inputId)
          span.name=topic.Name

mixin topicSelectMulti(name, topics, selected)
  details
    summary Select topics
    .multi-checkbox.scroll
      each topic in topics
        - var inputId = fmt.Sprintf("topic-%d", topic.ID)
        if utils.SliceContains(selected, topic.ID)
          label(for=inputId)
            input(type='checkbox', name=name, value=topic.ID, id=inputId, checked='checked')
            span.name=topic.Name
        else
          label(for=inputId)
            input(type='checkbox', name=name, value=topic.ID, id=inputId)
            span.name=topic.Name

mixin topicSelectSingle(name, topics, selected)
  select(name=name style="width:140px")
    option(value='') Select topic
    each topic in topics
      if utils.SliceContains(selected, topic.ID)
        option(value=topic.ID, selected='selected')=topic.Name
      else
        option(value=topic.ID)=topic.Name

mixin formOption(value, selected, label)
  if value == selected
    option(value=value selected='')=label
  else
    option(value=value)=label

mixin formInput(name, value, label)
  p
    label=label
    input(name=name value=value)

mixin formTextarea(name, value, label)
  p
    label=label
    textarea(name=name)=value

mixin formSwitch(name, condition, label)
  label.switch
    =label
    | &nbsp;
    if condition
      input(type='checkbox' name=name checked='checked')
    else
      input(type='checkbox' name=name)
    span.slider

mixin roleSelectMulti(name, roles, selected)
  .multi-checkbox.scroll
    each role in roles
      - var inputId = fmt.Sprintf("role-%d", role.ID)
      if utils.SliceContains(selected, role.ID)
        label(for=inputId)
          input(type='checkbox', name=name, value=role.ID, id=inputId, checked='checked')
          span.name=role.Name
      else
        label(for=inputId)
          input(type='checkbox', name=name, value=role.ID, id=inputId)
          span.name=role.Name

mixin topicList(topics)
  div.topics
    each topic in topics
      a(href=topic.Url() title=topic.Name)="# "+topic.Name


mixin postMeta(post)
  .meta.flex
    !=post.User.AvatarElm('32', '32', false)
    div
      a.author(href=post.User.Url() title=post.User.Name())=post.User.Name()
      div.stat.flex
        time(datetime=post.CreatedAt.Format("2006-01-02T15:04:05-0700")).date=post.CreatedAt.Format("January 2, 2006")
        span.views
          =fmt.Sprintf("%d views", post.ViewCount)
        span.comment
          =fmt.Sprintf("%d comments", post.CommentCount)

mixin postCard(post)
  - var postUrl = post.Url()
  - var bgStyle = ""

  if post.FeaturedImage != nil
    - bgStyle = fmt.Sprintf("background-image:url('%s')", post.FeaturedImage.Url())
  article.box
    a.overlay(href=postUrl title=post.Name)=post.Name
    if post.FeaturedImage != nil && post.FeaturedImage.ID > 0
      a.bg(href=postUrl title=post.Name style=bgStyle)=post.Name
    .box-content
      +postMeta(post)
      .info
        h3
          a(href=postUrl title=post.Name)=post.Name
        .tags
          for topic in post.Topics
            a(href=topic.Url() title=topic.Name)='#'+topic.Name

mixin postListItem(post, pos)
  article
    h4
      if pos > 0
        span.pos=fmt.Sprintf("# %d", pos)
      a(href=post.Url() title=post.Name)=post.Name
    .tags
      for topic in post.Topics
        a(href=topic.Url() title=topic.Name)='#'+topic.Name

mixin commentView(comment, postID, editCondition, extraInfo)
  if extraInfo
    h4(style='margin:0 0 10px')
      a(href=comment.Post.Url() target='_blank')=comment.Post.Name
  .comment.box.flex(id=fmt.Sprintf("comment-%d", comment.ID))
    !=comment.User.AvatarElm('30', '30', false)
    div
      a.author(href=comment.User.Url())=comment.User.Name()
      | &nbsp;&nbsp;
      span.date=comment.CreatedAt.Format("January 2, 2006 15:04 MST")
      .content
        !=comment.ContentHTML
        if editCondition
          .actions
            a.edit-comment(href='#', data-id=comment.ID) Edit
            | &nbsp;&nbsp;
            a.delete-comment(href='#', data-id=comment.ID) Delete
            if extraInfo
              - var commentUrl = fmt.Sprintf("%s#comment-%d", comment.Post.Url(), comment.ID)
              - var postCommentsUrl = fmt.Sprintf("/manage/comments?post=%d", postID)
              - var userCommentsUrl = fmt.Sprintf("/manage/comments?user=%d", postID)

              | &nbsp;&nbsp;
              a.view-comment(href=commentUrl target='_blank') View
              if meta.User.IsRoot()
                | &nbsp;&nbsp;
                a.post-comments(href=postCommentsUrl) All Post comments
                | &nbsp;&nbsp;
                a.post-comments(href=userCommentsUrl) All User comments
      if editCondition
        form(method="post" action=fmt.Sprintf("/comments/%d", comment.ID))
          input(type="hidden" name="post_id" value=postID)
          textarea(name="content" placeholder="Write your comment here...")=comment.Content
          button(type="submit") Update
